\chapter{Theoretical background}



\section{Introduction to survival analysis}

define survival data

what is $S, f, F, \lambda, \Lambda$

common of use is random censorship model (RCM)
A commonly used assumption in survival analysis is that 

kaplan meyer estimator, fully non-parametric

\section{RCM and the bootstrap}

An early study on the usage of bootstrap methods for analyzing standard errors of location estimates for (right-)censored data was made by Efron\cite{PAPER1}. 
Some parameter $\theta(F)$ should be estimated through its estimator $\hat{\theta} = \theta(\hat{F}_n)$, which could be the median, mean or something similar. 
For measuring the accuracy of $\hat{\theta}$, Efron proposes to use the bootstrap version of the standard deviation instead of the usual accuracy measure, which is Greenwood's formula $\hat{\sigma}_{GREEN}$. To obtain this new $\hat{\sigma}_{BOOT}$, he proposes the following resampling scheme for uncensored data:
\begin{resampling_scheme}
\begin{itemize}
\item[(A)] Draw $X_1^*,\ldots,X_n^*$ from $\hat{F}_n$
\item[(B)] Calculate $\hat{\theta}^* = \theta(\hat{F}_n^*)$, where $\hat{F}_n^*$ is the empirical distribution function of the bootstrap sample
\item[(C)] Repeat (A) and (B) N times to obtain $\hat{\theta}_1^*,\ldots,\hat{\theta}_N^*$
\end{itemize}
\end{resampling_scheme}
Then 
\[
\hat{\sigma}_{BOOT} = \sqrt{\frac{\sum_{j=1}^{N}\left(\hat{\theta}_j^*\right)^2 - \left(\sum_{j=1}^{N}\hat{\theta}_j^*\right)^2/N}{N-1}}
\]
is the nonparametric maximum likelihood estimator of $\sigma(F)$.
Efron then shows that for right-censored data under RCM, the above resampling scheme can directly be transferred by replacing $\hat{F}_n$ with the Kaplan-Meier estimator of the survival function $\hat{S}_n^{km}$ and drawing the bootstrap samples $(Z_1^*,\delta_1^*),\ldots,(Z_n^*,\delta_n^*)$ in step (A) with replacement from $(Z_1,\delta_1),\ldots,(Z_n,\delta_n)$.

Finally he compares different location estimates and their accuracy based on $\hat{\sigma}_{BOOT}$ and $\hat{\sigma}_{GREEN}$, to come to the conclusion that the results for $\hat{\sigma}_{BOOT}$ match very well with those of $\hat{\sigma}_{GREEN}$.

He also constructs confidence intervals for $\hat{\theta}$ based on the bootstrap cumulative distribution function $CDF_*(t) = \mathbb{P}_*(\hat{\theta}^*\leq t)$ of $\hat{\theta}_1^*,\ldots,\hat{\theta}_N^*$ by using its $\alpha$- and $1-\alpha$-percentiles.


\section{The semiparametric random cencorship model (SRCM) and its estimators}

The commonly used random censorship model can be extended by assuming a parametric regression model for the $\delta_i$. This means that we assume the conditional expectation $m(z) = \mathbb{P}(\delta = 1\mid Z=z) = \mathbb{E}(\delta \mid Z=z)$ to be described by some parametric family $\mathcal{M}:= \{m(\cdotp,\theta) \mid \theta \in \Theta\}$. This could be for example logit or probit models. 
By using this semiparametric random censorship model (SRCM) different new estimators for the survival function $S$ where obtained.

Dikta proposed that, under SRCM, the Kaplan-Meyer estimator can be outsmarted by a semiparametric estimator for $F$:
\begin{equation}\label{fnse1}
1-F_n^{se1}(t) = \prod_{i:Z_i \leq t} \left( \frac{n-R_{i,n}}{n-R_{i,n} + 1} \right)^{m(Z_i,\hat{\theta}_n)}
\end{equation}
where $\hat{\theta}_n$ is the maximum likelihood estimator of $\theta_0$, the true parameter of $m$.
He shows uniform consistency and a functional central limit result for this estimator. A comparison to the Kaplan-Meier estimator in terms of asymptotic variance showed that under correct model assumptions the new estimator is superior\cite{PAPER2}.

Two years later Dikta proposed a modification of the above estimator:
\begin{equation}\label{fnse2}
1-F_n^{se2}(t) = \prod_{i:Z_i \leq t} \left( 1 - \frac{m(Z_i,\hat{\theta}_n)}{n-R_{i,n} + 1} \right)
\end{equation}
The main difference between the two estimators is that $F_n^{se1}(Z_{n:n}) = 1$, while $F_n^{se2}(Z_{n:n}) < 1$ in most cases, which matches with the behavior of $F_n^{km}(t)$. Under heavy censoring, especially when the largest observation $Z_{n:n}$ is censored, $F_n^{se1}$ attaches substantial mass to $Z_{n:n}$, which is not that realistic. Still all the results for $F_n^{se1}$ can be directly be transfered to $F_n^{se2}$. 
Dikta establishes a strong law for integrals of arbitrary Borel-measurable functions when the estimator $F_n^{se2}$ is used for $F$ under SRCM\cite{PAPER3}.

Recently Dikta, Reißel and Harlaß used a new approach to obtain a new semiparametric estimator for $S$ under SRCM. They use explicit and implicit Euler schemes to solve an identifying Volterra type integral equation. While the explicit approach results in the above estimator $F_n^{se2}$, the implicit approach yields a new semiparametic estimator:
\begin{equation}\label{fnse2}
1-F_n^{se3}(t) = \prod_{i:Z_i \leq t} \left( 1 - \frac{m(Z_i,\hat{\theta}_n)}{n-R_{i,n} + m(Z_i,\hat{\theta}_n)} \right)
\end{equation}
The advantage of this estimator is that because $F_n^{se3}(Z_{n:n}) = 1$ it is a real probability distribution function and not a sub-distribution function. This results in better performance for small sample sizes in respect to bias. Also 
The authors propose to use $F_n^{se3}$ as a plug-in estimator for $\int\phi dF$ and study it with respect to strong consistency, asymptotic normality and efficiency. The result is a strong law for $F_n^{se3}$ when the model is correct. In simulation studies they show that, under correct model assumption, the semiparametric estimator performs significantly better than the Kaplan-Meier estimator\cite{PAPER7}.

\section{Bootstrap-based goodness-of-fit tests for SRCM}

\section{Simultaneous confidence bands for survival functions}